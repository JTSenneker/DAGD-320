package as3 {		import flash.display.MovieClip;	import flash.events.*;		public class Scene2 extends Scene {				var buffer:String = "";		var charSplit:String = "\n";				public function Scene2() {			textChat.addEventListener(KeyboardEvent.KEY_DOWN, handleKeyChat);			bttnChat.addEventListener(MouseEvent.CLICK, handleClickChat);						ChatApp.socket.addEventListener(ProgressEvent.SOCKET_DATA, handleData);		}		function handleData(e:ProgressEvent):void {			buffer += ChatApp.socket.readUTFBytes(ChatApp.socket.bytesAvailable);			var messages:Array = buffer.split(charSplit);			buffer = messages.pop();						for(var i = 0; i < messages.length; i++){				textMain.text += messages[i] + "\n";			}				}		function handleKeyChat(e:KeyboardEvent):void {			if(e.keyCode == 13) sendMsg();		}		function handleClickChat(e:MouseEvent):void {			sendMsg();		}		function sendMsg():void {			ChatApp.socket.writeUTFBytes(textChat.text + charSplit);			ChatApp.socket.flush();			textChat.text = "";		}		public override function dispose():void {			textChat.removeEventListener(KeyboardEvent.KEY_DOWN, handleKeyChat);			bttnChat.removeEventListener(MouseEvent.CLICK, handleClickChat);			ChatApp.socket.removeEventListener(ProgressEvent.SOCKET_DATA, handleData);		}	}}